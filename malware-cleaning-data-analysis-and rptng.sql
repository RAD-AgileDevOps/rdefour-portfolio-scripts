/*
Data Engineer: Roger De Four
Date: 2023-09-27 13:11
Description : SQL scripts for reporting and data analysis
							

*/
CREATE  VIEW vw_summary_malware_report    as 

SELECT  "level3"  , "level4"  , COUNT("logid") as num_count 
FROM  tbl_scanreport_20230926
where  "level3" ILIKE 'public_html' and (  "level4" NOT ILIKE ''  OR  
 "level4"  IS NOT NULL)
GROUP BY    ROLLUP("level3" , "level4")
 ;
 
 
 
 -- SELECT * FROM  vw_summary_malware_report ;
 
 COPY  (SELECT * FROM  vw_summary_malware_report ORDER BY num_count DESC) TO 
 'D:\RADFS Clients\caribbean Dev Group\MatthewChickoree\tnthomesforsale_troubleshooting\2023-08-23_malware_cleanup\management-reports\vw_summary_malware_report.csv' 
 WITH (HEADER true , FORMAT 'csv' , DELIMITER ',' , ENCODING 'utf-8') ;
 
 
 SELECT * FROM  tbl_scanreport_20230926
 
 WHERE "level4" ILIKE '%tnthomesforsale.com%' ;